# Contributor: Nick Black <dankamongmen@gmail.com>
pkgname=catena
pkgver=0.0.5
pkgrel=0
pkgdesc="Distributed ledger for health records"
url="https://github.com/headwayplatform/scblockchain"
arch="all"
license="Apache-2.0"
depends="openssl capnproto readline libmicrohttpd"
makedepends="ctags nlohmann-json-dev readline-dev libmicrohttpd-dev"
source="scblockchain-$pkgver.tar.gz::https://github.com/Sharecare/scblockchain/archive/v"$pkgver".tar.gz"
builddir="$srcdir/scblockchain-$pkgver"

build() {
	cd "$builddir"
	make
}

check() {
	cd "$builddir"
	make check
}

package() {
	cd "$builddir"
	install -D -m755 "$builddir"/doc/$pkgname.initd "$pkgdir"/etc/init.d/$pkgname
	install -D -m644 "$builddir"/doc/$pkgname.confd "$pkgdir"/etc/conf.d/$pkgname
	install -D -m755 "$builddir"/.out/catena "$pkgdir"/usr/bin/catena
	install -D -m644 "$builddir"/genesisblock "$pkgdir"/var/lib/catena/ledger
	install -D -m644 "$builddir"/doc/seedpeers "$pkgdir"/var/lib/catena/seedpeers
}

sha512sums="505888f1e0fe39f7e60cd3b08a947ce64d62a568b77ed4644816cc6d37e789a2b68375bd416e4c8c737dc47f0edaadd638a4e658e376871516da9e0b6ebddbe5  scblockchain-0.0.4.tar.gz"
